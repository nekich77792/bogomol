{"version":3,"sources":["classes.js","inputs.js","physics.js","platforms.js","time.js","graph.js","canvasRenderer/sprite.js","levelEditor.js","canvasRenderer/canvasRenderer.js","code.js","../../../usr/local/lib/node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["GameObj","x","y","pos","Platform","w","R","L","IDLE","GO","JUMP","DEATH","HERO","ENEMY1","LiveObj","type","state","vel","dir","attack","State","lvl","hero","enemies","steering","mouse","mouseChanged","st","Input","keyboard","init","addEventListener","onKeyPress","onKeyUp","onMouseDown","onMouseUp","e","key","space","s","a","d","readInput","input","act","Number","applyEnemyPhysics","applyPhysics","enemy","Math","abs","forEach","i","length","p","createLvl","n","shift","step","drawAxes","ctx","beginPath","moveTo","lineTo","font","fillText","strokeStyle","closePath","stroke","drawSqrt","sqrt","Sprite","img","anims","currentFrame","currentState","animKey","get","x0","y0","h","spriteTime","allFrames","currN","floor","srcX","save","translate","scale","xx","yy","ww","hh","drawImage","strokeRect","drawOrigin","restore","lineWidth","Anim","drawPlatform","sprites","Map","cam","initRender","canvas","document","getElementById","getContext","fillStyle","loadAssets","heroSprite","createHeroSprite","set","createEnemy1Sprite","heroImage","Image","src","forestboy","enemyImage","enemySheet","coords","round","render","clearRect","width","height","fillRect","draw","liveObject","sprite","window","initState","pxToKm","pow","garbageCollector","time","splice","loop","requestAnimationFrame","updateState","xm","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","push","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","JSON","parse","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","console","clear","hmrApply","v","hmrAcceptRun","reload","close","onclose","log","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","body","appendChild","remove","createElement","stackTrace","innerText","innerHTML","getParents","modules","parents","k","dep","Array","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"code.7f948419.js","sourceRoot":"..","sourcesContent":["class GameObj{\n\n\tconstructor(x,y){\n\t\tthis.pos = {x,y}\n\t}\n\n\n};\n\nexport class Platform extends GameObj{\n\tconstructor(x,y,w){\n\n\t\tsuper(x,y);\n\t\tthis.w = w;\n\t}\n}\n// --- consts ----\nexport const R = 1\nexport const L = -1\n\n//-- states -----\nexport const IDLE = 0;\nexport const GO = 1;\nexport const JUMP = 2;\nexport const DEATH = 3;\n\n\n//--- types ----\nexport const HERO = 0;\nexport const ENEMY1 = 1;\n\n\nexport class LiveObj extends GameObj{\n\n\tconstructor(type,x,y, state = IDLE){\n\t\tsuper(x,y)\n\t\tthis.vel = {x:0,y:0}\n\t\tthis.state = state;\n\t\tthis.type = type;\n\t\tthis.dir = R \n\t\tthis.attack = -1\n\t}\n\n}\n\n\n\n\nexport class State{\n\tconstructor(lvl){\n\t\tthis.hero = new LiveObj(HERO, 10, 10, IDLE);\n\t\t//this.enemy = new LiveObj(ENEMY1, 490, 20, GO);\n\t\tthis.enemies = [new LiveObj(ENEMY1, 490, 20, GO),\n\t\t\t\t\t\tnew LiveObj(ENEMY1, 300, 100, GO),]\n\t\tthis.lvl = lvl;\n\t\t//this.cam = {x:0,y:0}\n\n\t}\n\n\tupdateState({steering, mouse, mouseChanged}){\n\t \tif (mouseChanged){\n\t\t\tthis.hero.attack = 0\n\t\t}\n\t\telse if (this.hero.attack >= 20){\n\t\t\tthis.hero.attack = -1\n\t\t}\n\t\telse if (this.hero.attack >= 0){\n\t\t\tthis.hero.attack++\n\t\t}\n\t\t\n\n\t\tlet st = this.hero.state\n\t\tswitch (st){\n\t\t\tcase IDLE:\n\t\t\t\tif (steering.x != 0) {\n\t\t\t\t\tst = GO\n\t\t\t\t}else if(steering.y == 1){\n\t\t\t\t\tst=JUMP\n\t\t\t\t\tthis.hero.vel.y = -8\n\t\t\t\t}else {st=IDLE}\t\t\n\t\t\t\tbreak;\n\n\t\t\tcase GO :\n\t\t\t\tif (steering.x == 0) {\n\t\t\t\t\tst = IDLE\n\t\t\t\t}else if (steering.y == 1){\n\t\t\t\t\tst = JUMP\n\t\t\t\t\tthis.hero.vel.y = -8\n\t\t\t\t}else {st=GO}\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (steering.x > 0){\n\t\t\tthis.hero.dir = R\n\t\t}else if (steering.x < 0){\n\t\t\tthis.hero.dir = L\n\t\t}\n\t\t\n\n\t\tthis.hero.state = st\n\n\t}\n\n};\n\nexport class Input{\n\tconstructor(){\n\t\tthis.steering = {x:0,y:0}\n\t\tthis.mouse = false\n\t\tthis.mouseChanged = false\n\n\t}\n\n\n}","import {HERO, ENEMY1, JUMP, GO,IDLE,Input} from './classes'\nvar keyboard = {\"w\":false,\n\t\t\t\t\"s\":false,\n\t\t\t\t\"a\":false,\n\t\t\t\t\"d\":false,\n\t\t\t\t\"space\":false};\n\nvar mouse = false\nvar mouseChanged = false\n\n\nexport function init(w){\n\n\tw.addEventListener('keydown', onKeyPress);\n\n\tw.addEventListener('keyup', onKeyUp);\n\n\tw.addEventListener('mousedown', onMouseDown);\n\n\tw.addEventListener('mouseup', onMouseUp);\n\n\n}\n\nfunction onMouseUp(e){\n\tmouse = false\n}\n\n\nfunction onMouseDown(e){\n\tmouse = true\n\tmouseChanged = true\n}\n\nfunction onKeyPress(e){\n\n\tswitch(e.key)\n\n\t{\n\t\tcase(\" \"):\n\t\t\tkeyboard.space = true;\n\t\t\tbreak;\n\n\t\tcase(\"w\"):\n\t\t\tkeyboard.w = true;\n\t\t\tbreak;\n\n\t\tcase(\"s\"):\n\t\t\tkeyboard.s = true;\n\t\t\tbreak;\n\n\t\tcase(\"a\"):\n\t\t\tkeyboard.a = true;\n\t\t\tbreak;\n\n\t\tcase(\"d\"):\n\t\t\tkeyboard.d = true;\n\t\t\tbreak;\n\n\t}\n\n\t\n}\n\nfunction onKeyUp(e){\n\n\tswitch(e.key)\n\n\t{\n\t\tcase(\" \"):\n\t\t\tkeyboard.space = false;\n\t\t\tbreak;\n\n\t\tcase(\"w\"):\n\t\t\tkeyboard.w = false;\n\t\t\tbreak;\n\n\t\tcase(\"s\"):\n\t\t\tkeyboard.s = false;\n\t\t\tbreak;\n\n\t\tcase(\"a\"):\n\t\t\tkeyboard.a = false;\n\t\t\tbreak;\n\n\t\tcase(\"d\"):\n\t\t\tkeyboard.d = false;\n\t\t\tbreak;\n\n\t}\n\n\t\n}\n\n\nexport function readInput(state){\n\n\tlet input = new Input()\n\n\tinput.act = keyboard.space\n\n\tinput.steering.y = Number(keyboard.w) - Number(keyboard.s)\n\tinput.steering.x = Number(keyboard.d) - Number(keyboard.a)\n\n\tinput.mouse = mouse\n\tinput.mouseChanged = mouseChanged\n\tmouseChanged = false // ЗЛО!\n\n\n\treturn input\n\n}","import {IDLE, GO, JUMP, L, R, DEATH} from './classes'\n\n\n\n//blabla\n\nfunction applyEnemyPhysics ({vel, pos, state, dir} ) {\n\t\n\tif (state == GO) {\n\t\tvel.x = -0.65\n\t\tvel.y += 0.25\n\t\tpos.x += vel.x\n\t\tpos.y += vel.y\n\n\t\tif (pos.y > 250){\n\t\t\tpos.y = 250;\n\t\t\tvel.y = 0\n\t\t}\n\t}\n\telse if (state == DEATH){\n\t\tvel.x = -0.65\n\t\tvel.y += 0.25\n\t\tpos.x += vel.x\n\t\tpos.y += vel.y\n\t}\t\n\n}\nexport function applyPhysics(s,input){\n\t\n\tfor (const enemy of s.enemies){\n\t\tif (enemy.state == DEATH) continue;\n\t\tif (Math.abs(enemy.pos.x - s.hero.pos.x) < 10 && \n\t\t\tMath.abs(enemy.pos.y - s.hero.pos.y) < 10 ){\n\t\t\t\tenemy.state = DEATH\n\t\t\t\tenemy.vel.y = -3\n\t\t\t}\n\n\t}\n\n\t// enemies physics\n\ts.enemies.forEach(applyEnemyPhysics);\n\n\t// hero physics\n\tconst {vel, pos, state, dir} = s.hero\n\n\n\tswitch (state) {\n\t\tcase IDLE:\n\t\t\tvel.x = 0\n\t\t\tbreak;\n\t\tcase GO:\n\t\t\tvel.x = input.steering.x \n\t\t\tbreak;\n\t\tcase JUMP:\t\t\t\n\t\t\tvel.x = input.steering.x \n\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\tvel.y += 0.25\n\tpos.x += vel.x * 2\n\tpos.y += vel.y\n\n\t// collistion with gnd\n\tif (pos.y > 250){\n\n\t\ts.hero.state = input.steering.x == 0 ? IDLE : GO\n\t\tpos.y = 250;\n\t\tvel.y = 0\n\t}\n  \n\n   for (var i = 0; i < s.lvl.length; i++) {\n   \t\tlet p = s.lvl[i]\n   \t\tif (pos.y > p.pos.y && \n   \t\t\tpos.x + 5 > p.pos.x && \n   \t\t\tpos.x - 5 < p.pos.x + p.w &&\n   \t\t\tpos.y < p.pos.y + 10){\n\t\t\t\tif (vel.y > 0 ){\n\t\t\t\t\ts.hero.state = input.steering.x == 0 ? IDLE : GO\n\t\t\t\t\tpos.y = p.pos.y;\n\t\t\t\t\tvel.y = 0\t\n\t\t\t\t}\n\t\t\t\t\n   \t\t\t\n\n   \t\t}\n   \t\n   }\n\n\n\n}","import {Platform} from './classes'\n\n\n\nexport function createLvl(){\n\n\tlet w = 50\n\n\treturn [\n\t\tnew Platform(200,200,w),\n\t\tnew Platform(250,150,w),\n\t\tnew Platform(300,100,w),\n\t\tnew Platform(350,50,w),\n\t\tnew Platform(400,0,w)\n\t]\n\t\n}\n\n","export default {n:0}; // количество дров прошедших со старта игры\n","\nconst shift = 250;\nconst step = 10;\n\nexport function drawAxes(ctx) {\n\n\tctx.beginPath();\n\tctx.moveTo(0, shift);\n\tctx.lineTo(500, shift);\n\tctx.moveTo(shift, 0);\n\tctx.lineTo(shift, 500);\n\n\tctx.font = '9px arial'\n\tfor (let x = 0; x <= 25; x++) {\n\n\t\tlet y = 260;\n\t\t//ctx.moveTo(x*step + shift, y);\n\t\tctx.fillText(x, x*step + shift, y);\n\n\t\t\n\t}\n\tctx.strokeStyle = 'rgb(0, 0, 0)';\n\n\tctx.closePath();\n\tctx.stroke();\n\n}\n\n\n\n\nexport function drawSqrt(ctx) {\n\n\t\n\t\n\n\tctx.beginPath();\n\tctx.moveTo(shift, shift);\n\n\tfor (let x = 0; x <= 25; x++) {\n\t\t\n\t\tlet y = Math.sqrt(x);\n\t\tctx.lineTo(x*step + shift, -y*step + shift)\n\n\n\n\t}\n \tctx.strokeStyle = 'rgb(255, 0, 0)';\n\t//ctx.closePath();\n\tctx.stroke();\n\n}","import {L} from './../classes'\nexport class Sprite {\n\tconstructor(img, anims){\n\t\tthis.img = img\n\t\tthis.anims = anims\n\t\tthis.currentFrame = 0\n\t\tthis.currentState\n\t\t//this.w = 16\n\t\t//this.h = 24\n\t}\n\n\tdraw(ctx, state, pos, dir, attack){\n\n\t\tif(this.currentState != state){\n\t\t\tthis.currentState = state\n\t\t\tthis.currentFrame = 0\n\n\t\t}\n\t\t//console.log(attack)\n\t\tlet animKey = attack >= 0 ? \"attack\" : state\n\t\tif (attack == 0) this.currentFrame = 0;\n\t\tconst {n, x0, y0, w, h, spriteTime, shift} = this.anims.get(animKey)\t\n\t\t//console.log(shift)\n\n\t\t\n\t\tconst allFrames = n * spriteTime\n\n\t\tlet currN = Math.floor(this.currentFrame/spriteTime)\n\t\t\n\t\tconst srcX = x0 + currN*w\n\n\t\t//console.log(vel)\n\t\t\n\t\tif (dir == L){ \n\n\t\t\tctx.save();\n\t\t\tctx.strokeStyle = 'red'\n\t\t\tctx.translate(pos.x, 0)\n\t\t\tctx.scale(-1, 1);\n\t\t\tlet xx = w - shift, yy = pos.y - h, ww = -w, hh = h\n\n\n\t\t\tctx.drawImage(this.img, srcX, y0, w, h, \n\t\t\t \txx, \n\t\t\t\tyy , ww, hh);\n\t\t\tctx.strokeRect(xx, yy , ww, hh);\n\t\t\tdrawOrigin(ctx, 0, pos.y)\n\t\t\tctx.restore();\n\t\t} else {\n\t\t\tctx.save()\n\t\t\tctx.translate(pos.x, 0)\n\t\t\tlet xx = -shift, yy = pos.y - h, ww = w, hh = h\n\t\t\tctx.drawImage(this.img, srcX, y0, w, h, \n\t\t\t \txx, //-shift,//pos.x - shift, \n\t\t\t\t yy , ww, hh);\n\n\t\t\tctx.strokeRect(xx, yy , ww, hh);\n\t\t\tdrawOrigin(ctx, 0, pos.y)\n\t\t\tctx.restore()\n\t\t}\n\n\n\t\tthis.currentFrame++;\n\t\tthis.currentFrame %= allFrames\n\t}\n}\n\nfunction drawOrigin(ctx, x, y){\n\tlet d = 20\n\tctx.save()\n\t\tctx.strokeStyle = 'green'\n\t\tctx.lineWidth = 1;\n\t\tctx.beginPath()\t\n\t\tctx.moveTo(x, y - d);\n\t\tctx.lineTo(x, y + d);\n\t\tctx.moveTo(x - d, y);\n\t\tctx.lineTo(x + d, y);\n\t\tctx.closePath()\n\t\tctx.stroke();\n\tctx.restore()\n}\n\nexport class Anim {\n\tconstructor(n, x0, y0, w, h,spriteTime, shift ){\n\t\tthis.n = n\n\t\tthis.x0 = x0\n\t\tthis.y0 = y0\n\t\tthis.w = w\n\t\tthis.shift = shift || w/2\n\t\tthis.h = h\n\t\tthis.spriteTime = spriteTime\n\t}\n}","export function drawPlatform() {\n\t\n}","import {drawAxes, drawSqrt} from './../graph'\nimport forestboy from './../ForestBoy.png'\nimport enemySheet from './../enemies.png'\nimport {HERO, ENEMY1, JUMP, GO,IDLE, DEATH} from './../classes'\nimport {Sprite, Anim} from './sprite'\nimport {} from './../levelEditor'\n\n\n// 22:36 воры уехали...\n\nconst sprites = new Map()\nconst cam = {x:250,y:0}\n\nlet ctx;\n\nexport function initRender(){\n\n\tconst canvas = document.getElementById('tututu');\n\tctx = canvas.getContext('2d');\n\tctx.fillStyle = 'rgba(0, 0, 200, 0.5)'\n}\n\n\nexport function loadAssets(state){\n\n\t// HERO\n\tconst heroSprite = createHeroSprite();\n\tsprites.set(state.hero, heroSprite);\n\n\t// ENEMY1\n\t//const enemy = createEnemy1Sprite();\n\n\tfor(let i = 0;i < state.enemies.length; i++){\n\t\tlet enemy = state.enemies[i]\n\t\tsprites.set (enemy ,createEnemy1Sprite(enemy) )\n\n\t}\n\t//sprites.set(ENEMY1, enemy);\n\n\n\n}\n\nfunction createHeroSprite (){\n\tconst anims  = new Map()\n\t//n, x0, y0, w, h,spriteTime , shift\n\tanims.set(GO,       new Anim(6, 11, 43, 16, 17, 5))\n\tanims.set(IDLE,     new Anim(3, 11, 12, 16, 18, 14))\n\tanims.set(JUMP,     new Anim(3, 59, 44, 16, 18, 10))\n\tanims.set(\"attack\", new Anim(4, 8, 122, 26, 18, 5, 6))\n\n\tconst heroImage = new Image();\n\theroImage.src = forestboy;\n\t//console.log (forestboy);\n\treturn new Sprite(heroImage, anims);\n}\n\nfunction createEnemy1Sprite (enemy){\n\tconst anims  = new Map()\n\t//n, x0, y0, w, h,spriteTime \n\tanims.set(GO, new Anim(4, 0, 0, 30, 15, 8))\n\tanims.set(DEATH, new Anim(4, 0, 0, 30, 15, 8))\n//\tanims.set(IDLE, new Anim(3, 11, 12, 16, 18, 14))\n//\tanims.set(JUMP, new Anim(3, 59, 44, 16, 18, 10))\n\n\tconst enemyImage = new Image();\n\tenemyImage.src = enemySheet;\n\treturn new Sprite(enemyImage, anims);\n\t\n}\n\n\n\n\n\n\nexport function coords (ctx, hero){\n\n\tctx.font = '15px arial'\n\tctx.fillText(Math.round(hero.pos.x)+':'+Math.round(hero.pos.y), 350 ,470 );\n\tctx.fillText(Math.round(hero.vel.x)+':'+Math.round(hero.vel.y), 350 ,485 );\n\n\n}\n\n\n\n\nexport function render(state) {\n//console.log(state.hero.x;\n//----- camera ---\n\tif (state.hero.pos.x > cam.x){\n\t\tcam.x = state.hero.pos.x \n\t\t\n\t}\n\n\tif (state.hero.pos.x < cam.x - 240){\n\t\tcam.x = state.hero.pos.x + 240\n\t\t\n\t}\n\n\n\t\n\tcam.y = state.hero.pos.y - 250\n\n\t\n\t\n\n\tctx.clearRect(0,0, ctx.canvas.width, ctx.canvas.height);\n\n\n\tctx.save();\n\tctx.translate(-(cam.x - 250), -cam.y)\n\n\tcoords(ctx, state.hero);\n\n  \tdrawAxes(ctx);\n\tdrawSqrt(ctx);\n\n\tfor (let i = 0; i < state.lvl.length; i++) {\n\n\t\tlet p = state.lvl[i]\n\t\t//ctx.fillStyle = 'rgb(200, 150, 150)'\n\t\tctx.fillStyle = 'lwn'\n\t\tctx.fillRect(p.pos.x, p.pos.y, p.w, 50);\n\n\t\t \n\t}\n\n\t//-- hero -------------\n\tconst {dir, pos, state: st, attack} = state.hero \n\tsprites.get(state.hero).draw(ctx, st, pos, dir, attack);\n\t//-- enemy ------------\n\n\tfor (let liveObject of state.enemies){\n\t\t//console.log(liveObject)\n\t\tlet sprite = sprites.get(liveObject)\n\t\tsprite.draw(ctx, liveObject.state, liveObject.pos, liveObject.dir);\n\t}\n\t//shadowPlarform();\n\n\tctx.restore();\n\n\t\n} \n\n","import {init as initInput, readInput} from './inputs'\nimport {applyPhysics} from './physics'\nimport {createLvl} from './platforms'\nimport {Platform, LiveObj, State} from './classes'\nimport  time from './time'\nimport {initRender, render, loadAssets} from './canvasRenderer/canvasRenderer'\n\nlet state;\n\n\n// --- init -----------------\nfunction init(){\n\n\tinitRender();\n\tinitInput(window);\n\tinitState();\n\tloadAssets(state);\n\n}\n\nfunction initState(){\t \n\tstate = new State(createLvl());\n};\n\n\n \n// ---  update ----\n\nfunction pxToKm (y){\n\treturn y*((198/108) * Math.pow(10, -5))\n}\n\nfunction garbageCollector(){\n\tif (time.n % 10 != 0) return;// hразряжаем\n\n\tfor (let i = 0; i < state.enemies.length; i++){\n\t\tconst {x,y} = state.enemies[i].pos;\n\t\tif (y > 300 || x < -10){\n\t\t\t//delete state.enemies[i];\n\t\t\tstate.enemies.splice(i, 1);\n\t\n\t\t}\n\t}\n}\n\n\n\nfunction loop(){\n\n\twindow.requestAnimationFrame(loop);\n\tconst input = readInput(state, input);\n\tstate.updateState(input);\n\tapplyPhysics(state, input);\n\t    \n\t//console.log(state.enemies[0].pos.y);\n\t// zzxsz\n\t\n\tgarbageCollector();\n\trender(state);\n\tlet xm = 50\n\tif (state.hero.vel.y == -5){\n\t\t//new Platform(Math.random()*500,Math.random()*500,xm)\n\t}\n\t\n\t// update time\n\ttime.n++\n\t\n}\n\n\n\n//--- start -----------\ninit();\n\nloop();\n/*\nvar audioCtx = new AudioContext();\n\nvar oscillator = audioCtx.createOscillator();\nvar gainNode = audioCtx.createGain();\n\noscillator.connect(gainNode);\ngainNode.connect(audioCtx.destination);\n\noscillator.detune.value = 0; // value in cents\n oscillator.start(0);\n\nsetInterval(()=>{\n\toscillator.detune.value = 1200; // value in cents\n\t// oscillator.start(0);\n\t\n\tsetInterval(()=>{\n\t\toscillator.detune.value = 700; // value in cents\n\t\t\n\t\t\tsetInterval(()=>{\n\t\t\toscillator.detune.value = 00; // value in cents\n\t\t\t\toscillator.stop(3);\n\t\t\t\n\t\t\n\t\t}, 1000)\n\t}, 1000)\n}, 1000)\n\n*/\n\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}